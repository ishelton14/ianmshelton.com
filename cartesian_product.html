<!DOCTYPE html>

<html>
	<head>
		<title>Self Join Proof</title>
	</head>
	<body style="background-color:lightgrey;font-family:Arial Black">
	
	<pre>
--use below table for example: 

create table courses 
( student_id integer, 
  course_id  integer
)

insert into courses values (1, 1) 
insert into courses values (1, 2) 
insert into courses values (1, 3) 
insert into courses values (2, 1) 
insert into courses values (3, 2) 
insert into courses values (3, 3) 

/*
courses table
student_id	course_id
1			1			
1			2
1			3
2			1
3			2
3			3
*/

/*
proof of self joins 
let x = value in column y
let x.row_count = # rows of value x in column y
let j = # of self joins to column y
*/

/*
general formula: 

# rows returned = (x1.row_count)^j + (x2.row_count)^j + ... (xn.row_count)^j

if all values of x are unique: 

# rows returned = (x1.row_count) + (x2.row_count) + ... (xn.row_count)

examples: 
*/

-- returns 14 rows (3^2 + 1^2 +2^2)
select c1.student_id, c2.student_id
from course as c1, course as c2
where c1.student_id=c2.student_id

-- returns 36 rows (3^3 + 1^3 +2^3)
select c1.student_id, c2.student_id, c3.student_id
from course as c1, course as c2, course as c3
where c1.student_id=c2.student_id
and c2.student_id=c3.student_id

-- returns 98 rows (3^4 + 1^4 +2^4)
select c1.student_id, c2.student_id, c3.student_id, c4.student_id
from course as c1, course as c2, course as c3, course as c4
where c1.student_id=c2.student_id
and c2.student_id=c3.student_id
and c3.student_id=c4.student_id

-- returns 216 rows (3^5 + 1^5 +2^5)
select c1.student_id, c2.student_id, c3.student_id, c4.student_id, c5.student_id
from course as c1, course as c2, course as c3, course as c4, course as c5
where c1.student_id=c2.student_id
and c2.student_id=c3.student_id
and c3.student_id=c4.student_id
and c4.student_id=c5.student_id
	</pre>
	
	</body>
</html>