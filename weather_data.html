<!DOCTYPE html>

<html>
	<head>
		<title>Weather Data</title>
	</head>
	<body style="background-color:lightgrey;font-family:Arial Black">
	
	<pre>
# Set Current Working Directory
setwd("C:\\Users\\Ian\\Desktop\\Rplots")

# Clear Variables
rm(list=ls())

# Clear Console (equivalent of Ctrl + L)
cat("\014")

# Install Packages
# install.packages("RSQLite")
# install.packages("sqldf")

# Load Packages
library(RSQLite)
library(sqldf)

getData <- function(city){
  data <- sqldf(paste("SELECT * FROM weather WHERE a1='", city, "'", sep=''))
  return(data)
}

connection <- dbConnect(SQLite(), "C:\\Users\\Ian\\Desktop\\Python\\Weather\\weather.db")
cityList <- dbGetQuery(connection, "SELECT DISTINCT a1 FROM Test")
weather <- dbGetQuery(connection, "SELECT * FROM Test WHERE g1=(SELECT MAX(g1) FROM Test)")
weather
i <- 1
as.Date(weather[,2], "%B %d")
counter <- 1
cities <- c("Atlanta", "Orlando", "Memphis", "Charlotte")
file.remove("weather.csv")
file.create("weather.csv")
# write.table(weather, "weather.csv", quote=FALSE, row.names=FALSE, col.names=FALSE, sep=",",
#             append=T)
dbDisconnect(connection)

for(counter in 1:length(cities)){
  data <- getData(cityList[counter,])
  print(data)
  write.table(data, "weather.csv", quote=FALSE, row.names=FALSE, col.names=FALSE, sep=",",
              append=T)
  png(paste("TempPlotsMod/", cities[counter], "_LineChart.png", sep=''),
      type="cairo", width=1000, height=600)
  ## add extra space to right margin of plot within frame
  par(mar=c(5, 4, 4, 6) + 0.1)
  
  plot(data[,3],  xaxt = "n", pch=16, axes=FALSE, xlab="", ylab="",
       type="b", col="Orange", 
       main=paste(data[1,5],": High Temperature vs Chance of Rain", sep=''))
  axis(2, col="Black", las=1)
  mtext("High Temperature", side=2, col="Orange",line=2.5)
  box()
  
  ## Allow a second plot on the same graph
  par(new=TRUE)
  plot(data[,4],  xaxt = "n", pch=15, axes=FALSE, xlab="", ylab="",
       type="b", col="Blue", ylim=c(0,100))
  mtext("Chance of Rain", side=4, col="Blue", line=2.5)
  axis(4, col="Black", las=1, col.axis="Black")
  axis(1,at=1:5,labels=data[,2])
  # axis(1,pretty(range(time4),10), las=2)
  mtext("Date",side=1,col="black",line=3.5)  
  grid(col="darkgrey")
  
  dev.off()
#   rm(data)
}
#shell.exec("weather.csv")

# file.remove("weather.csv")
# file.create("weather.csv")

	</pre>
	
	</body>
</html>